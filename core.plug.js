var mod=(()=>{var Me=Object.defineProperty;var lr=Object.getOwnPropertyDescriptor;var cr=Object.getOwnPropertyNames;var ur=Object.prototype.hasOwnProperty;var W=(e,t)=>{for(var n in t)Me(e,n,{get:t[n],enumerable:!0})},pr=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of cr(t))!ur.call(e,i)&&i!==n&&Me(e,i,{get:()=>t[i],enumerable:!(r=lr(t,i))||r.enumerable});return e};var mr=e=>pr(Me({},"__esModule",{value:!0}),e);var oa={};W(oa,{functionMapping:()=>sr});var O={};W(O,{del:()=>gr,get:()=>dr,set:()=>fr});typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});var m=self.syscall;function fr(e,t){return m("store.set",e,t)}function dr(e){return m("store.get",e)}function gr(e){return m("store.delete",e)}var c={};W(c,{confirm:()=>_r,dispatch:()=>Fr,downloadFile:()=>Sr,filterBox:()=>Mr,flashNotification:()=>kr,getCurrentPage:()=>hr,getCursor:()=>br,getSelection:()=>wr,getText:()=>xr,getUiOption:()=>Dr,hidePanel:()=>Lr,insertAtCursor:()=>$r,insertAtPos:()=>Nr,moveCursor:()=>Rr,navigate:()=>vr,openUrl:()=>Cr,prompt:()=>Ir,reloadPage:()=>Tr,replaceRange:()=>Or,save:()=>Ar,setPage:()=>yr,setSelection:()=>Pr,setUiOption:()=>Ur,showPanel:()=>Er,vimEx:()=>jr});function hr(){return m("editor.getCurrentPage")}function yr(e){return m("editor.setPage",e)}function xr(){return m("editor.getText")}function br(){return m("editor.getCursor")}function wr(){return m("editor.getSelection")}function Pr(e,t){return m("editor.setSelection",e,t)}function Ar(){return m("editor.save")}function vr(e,t,n=!1,r=!1){return m("editor.navigate",e,t,n,r)}function Tr(){return m("editor.reloadPage")}function Cr(e){return m("editor.openUrl",e)}function Sr(e,t){return m("editor.downloadFile",e,t)}function kr(e,t="info"){return m("editor.flashNotification",e,t)}function Mr(e,t,n="",r=""){return m("editor.filterBox",e,t,n,r)}function Er(e,t,n,r=""){return m("editor.showPanel",e,t,n,r)}function Lr(e){return m("editor.hidePanel",e)}function Nr(e,t){return m("editor.insertAtPos",e,t)}function Or(e,t,n){return m("editor.replaceRange",e,t,n)}function Rr(e,t=!1){return m("editor.moveCursor",e,t)}function $r(e){return m("editor.insertAtCursor",e)}function Fr(e){return m("editor.dispatch",e)}function Ir(e,t=""){return m("editor.prompt",e,t)}function _r(e){return m("editor.confirm",e)}function Dr(e){return m("editor.getUiOption",e)}function Ur(e,t){return m("editor.setUiOption",e,t)}function jr(e){return m("editor.vimEx",e)}var P={};W(P,{batchSet:()=>Yr,clearPageIndex:()=>Kr,clearPageIndexForPage:()=>Vr,del:()=>qr,deletePrefixForPage:()=>Gr,get:()=>Hr,query:()=>Qr,queryPrefix:()=>Wr,set:()=>Br});function Br(e,t,n){return m("index.set",e,t,n)}function Yr(e,t){return m("index.batchSet",e,t)}function Hr(e,t){return m("index.get",e,t)}function qr(e,t){return m("index.delete",e,t)}function Wr(e){return m("index.queryPrefix",e)}function Qr(e){return m("index.query",e)}function Vr(e){return m("index.clearPageIndexForPage",e)}function Gr(e,t){return m("index.deletePrefixForPage",e,t)}function Kr(){return m("index.clearPageIndex")}var v={};W(v,{parseMarkdown:()=>Ee});function Ee(e){return m("markdown.parseMarkdown",e)}var Le=class{listPages(t=!1){return m("space.listPages",t)}getPageMeta(t){return m("space.getPageMeta",t)}readPage(t){return m("space.readPage",t)}writePage(t,n){return m("space.writePage",t,n)}deletePage(t){return m("space.deletePage",t)}listPlugs(){return m("space.listPlugs")}listAttachments(){return m("space.listAttachments")}getAttachmentMeta(t){return m("space.getAttachmentMeta",t)}readAttachment(t){return m("space.readAttachment",t)}writeAttachment(t,n,r){return m("space.writeAttachment",t,n,r)}deleteAttachment(t){return m("space.deleteAttachment",t)}readFile(t,n){return m("space.readFile",t,n)}getFileMeta(t){return m("space.getFileMeta",t)}writeFile(t,n,r){return m("space.writeFile",t,n,r)}deleteFile(t){return m("space.deleteFile",t)}listFiles(t){return m("space.listFiles",t)}},g=new Le;var L={};W(L,{getEnv:()=>ti,invokeCommand:()=>Zr,invokeFunction:()=>Xr,listCommands:()=>Jr,reloadPlugs:()=>ei});function Xr(e,t,...n){return m("system.invokeFunction",e,t,...n)}function Zr(e){return m("system.invokeCommand",e)}function Jr(){return m("system.listCommands")}function ei(){m("system.reloadPlugs")}function ti(){return m("system.getEnv")}async function ut(){await O.get("vimMode")&&await c.setUiOption("vimMode",!0),await O.get("darkMode")&&await c.setUiOption("darkMode",!0)}async function pt(){let e=await O.get("darkMode");e=!e,await c.setUiOption("darkMode",e),await O.set("darkMode",e)}function mt(e){let t=atob(e),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}function ri(e){let t="",n=e.byteLength;for(let r=0;r<n;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function ft(e,t){return`data:${e};base64,${ri(t)}`}var _=self.syscall;var R={};W(R,{dispatchEvent:()=>oi,listEvents:()=>ai});function oi(e,t,n){return new Promise((r,i)=>{let o=-1;n&&(o=setTimeout(()=>{console.log("Timeout!"),i("timeout")},n)),_("event.dispatch",e,t).then(a=>{o!==-1&&clearTimeout(o),r(a)}).catch(i)})}function ai(){return _("event.list")}function D(e){if(!!e.children)for(let t of e.children){if(t.parent)return;t.parent=e,D(t)}}function dt(e,t){let n=e.parent;for(;n;){if(t(n))return n;n=n.parent}return null}function U(e,t){return z(e,n=>n.type===t)}function z(e,t){if(t(e))return[e];let n=[];if(e.children)for(let r of e.children)n=[...n,...z(r,t)];return n}function F(e,t){if(e.children){let n=e.children.slice();for(let r of n){let i=t(r);if(i!==void 0){let o=e.children.indexOf(r);i?e.children.splice(o,1,i):e.children.splice(o,1)}else F(r,t)}}}function j(e,t){return z(e,n=>n.type===t)[0]}function Ne(e,t){z(e,t)}function X(e,t){if(t<e.from||t>=e.to)return null;if(!e.children)return e;for(let n of e.children){let r=X(n,t);if(r&&r.text!==void 0)return e;if(r)return r}return null}function S(e){let t=[];if(e.text!==void 0)return e.text;for(let n of e.children)t.push(S(n));return t.join("")}function I(e,t){let n=[];if(e.filter.length===0)n=t.slice();else{e:for(let r of t){let i=r;for(let{op:o,prop:a,value:s}of e.filter)switch(o){case"=":{let l=i[a];if(Array.isArray(l)&&!Array.isArray(s)){if(!l.includes(s))continue e}else if(Array.isArray(l)&&Array.isArray(s)){if(!l.some(u=>s.includes(u)))continue e}else if(l!=s)continue e;break}case"!=":if(i[a]==s)continue e;break;case"<":if(!(i[a]<s))continue e;break;case"<=":if(!(i[a]<=s))continue e;break;case">":if(!(i[a]>s))continue e;break;case">=":if(!(i[a]>=s))continue e;break;case"=~":if(!new RegExp(s).exec(i[a]))continue e;break;case"!=~":if(new RegExp(s).exec(i[a]))continue e;break;case"in":if(!s.includes(i[a]))continue e;break}n.push(i)}}return e.ordering.length>0&&(n=n.sort((r,i)=>{for(let{orderBy:o,orderDesc:a}of e.ordering){if(r[o]<i[o]||r[o]===void 0)return a?1:-1;if(r[o]>i[o]||i[o]===void 0)return a?-1:1}return 0})),e.limit&&(n=n.slice(0,e.limit)),e.select&&(n=n.map(r=>{let i={};for(let o of e.select)i[o]=r[o];return i})),n}function Z(e){F(e,t=>{if(t.type!=="Directive")return;let n=S(t);return{from:t.from,to:t.to,text:new Array(n.length+1).join(" ")}})}var N=class extends Error{constructor(n="(unknown reason)",r=""){super(`${n} ${r}`);this.mark=r;this.name=this.constructor.name}toString(n){return`${this.name}: ${this.message} ${this.mark}`}};function gt(e){return typeof e=="boolean"||e instanceof Boolean}function ht(e){return e!==null&&typeof e=="object"}function k(e,t){let n="";for(let r=0;r<t;r++)n+=e;return n}function ae(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var de=class{constructor(t,n,r,i,o){this.name=t;this.buffer=n;this.position=r;this.line=i;this.column=o}getSnippet(t=4,n=75){if(!this.buffer)return null;let r="",i=this.position;for(;i>0&&`\0\r
\x85\u2028\u2029`.indexOf(this.buffer.charAt(i-1))===-1;)if(i-=1,this.position-i>n/2-1){r=" ... ",i+=5;break}let o="",a=this.position;for(;a<this.buffer.length&&`\0\r
\x85\u2028\u2029`.indexOf(this.buffer.charAt(a))===-1;)if(a+=1,a-this.position>n/2-1){o=" ... ",a-=5;break}let s=this.buffer.slice(i,a);return`${k(" ",t)}${r}${s}${o}
${k(" ",t+this.position-i+r.length)}^`}toString(t){let n,r="";return this.name&&(r+=`in "${this.name}" `),r+=`at line ${this.line+1}, column ${this.column+1}`,t||(n=this.getSnippet(),n&&(r+=`:
${n}`)),r}};function Oe(e,t,n){let r=[];for(let i of e.include)n=Oe(i,t,n);for(let i of e[t]){for(let o=0;o<n.length;o++){let a=n[o];a.tag===i.tag&&a.kind===i.kind&&r.push(o)}n.push(i)}return n.filter((i,o)=>!r.includes(o))}function pi(...e){let t={fallback:{},mapping:{},scalar:{},sequence:{}};for(let n of e)for(let r of n)r.kind!==null&&(t[r.kind][r.tag]=t.fallback[r.tag]=r);return t}var M=class{constructor(t){this.explicit=t.explicit||[],this.implicit=t.implicit||[],this.include=t.include||[];for(let n of this.implicit)if(n.loadKind&&n.loadKind!=="scalar")throw new N("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");this.compiledImplicit=Oe(this,"implicit",[]),this.compiledExplicit=Oe(this,"explicit",[]),this.compiledTypeMap=pi(this.compiledImplicit,this.compiledExplicit)}extend(t){return new M({implicit:[...new Set([...this.implicit,...t?.implicit??[]])],explicit:[...new Set([...this.explicit,...t?.explicit??[]])],include:[...new Set([...this.include,...t?.include??[]])]})}static create(){}};var mi=()=>!0,fi=e=>e;var y=class{constructor(t,n){this.kind=null;this.resolve=()=>!0;this.construct=t=>t;this.tag=t,n&&(this.kind=n.kind,this.resolve=n.resolve||mi,this.construct=n.construct||fi,this.instanceOf=n.instanceOf,this.predicate=n.predicate,this.represent=n.represent,this.defaultStyle=n.defaultStyle,this.styleAliases=n.styleAliases)}};var Re=class extends Error{constructor(t){super(t),this.name="DenoStdInternalError"}};function xt(e,t=""){if(!e)throw new Re(t)}function se(e,t,n=0){n=Math.max(0,Math.min(n,t.byteLength));let r=t.byteLength-n;return e.byteLength>r&&(e=e.subarray(0,r)),t.set(e,n),e.byteLength}var ge=32*1024,$e=2**32-2,le=class{#e;#t=0;constructor(t){this.#e=t===void 0?new Uint8Array(0):new Uint8Array(t)}bytes(t={copy:!0}){return t.copy===!1?this.#e.subarray(this.#t):this.#e.slice(this.#t)}empty(){return this.#e.byteLength<=this.#t}get length(){return this.#e.byteLength-this.#t}get capacity(){return this.#e.buffer.byteLength}truncate(t){if(t===0){this.reset();return}if(t<0||t>this.length)throw Error("bytes.Buffer: truncation out of range");this.#n(this.#t+t)}reset(){this.#n(0),this.#t=0}#i(t){let n=this.#e.byteLength;return t<=this.capacity-n?(this.#n(n+t),n):-1}#n(t){xt(t<=this.#e.buffer.byteLength),this.#e=new Uint8Array(this.#e.buffer,0,t)}readSync(t){if(this.empty())return this.reset(),t.byteLength===0?0:null;let n=se(this.#e.subarray(this.#t),t);return this.#t+=n,n}read(t){let n=this.readSync(t);return Promise.resolve(n)}writeSync(t){let n=this.#r(t.byteLength);return se(t,this.#e,n)}write(t){let n=this.writeSync(t);return Promise.resolve(n)}#r(t){let n=this.length;n===0&&this.#t!==0&&this.reset();let r=this.#i(t);if(r>=0)return r;let i=this.capacity;if(t<=Math.floor(i/2)-n)se(this.#e.subarray(this.#t),this.#e);else{if(i+t>$e)throw new Error("The buffer cannot be grown beyond the maximum size.");{let o=new Uint8Array(Math.min(2*i+t,$e));se(this.#e.subarray(this.#t),o),this.#e=o}}return this.#t=0,this.#n(Math.min(n+t,$e)),n}grow(t){if(t<0)throw Error("Buffer.grow: negative count");let n=this.#r(t);this.#n(n)}async readFrom(t){let n=0,r=new Uint8Array(ge);for(;;){let i=this.capacity-this.length<ge,o=i?r:new Uint8Array(this.#e.buffer,this.length),a=await t.read(o);if(a===null)return n;i?this.writeSync(o.subarray(0,a)):this.#n(this.length+a),n+=a}}readFromSync(t){let n=0,r=new Uint8Array(ge);for(;;){let i=this.capacity-this.length<ge,o=i?r:new Uint8Array(this.#e.buffer,this.length),a=t.readSync(o);if(a===null)return n;i?this.writeSync(o.subarray(0,a)):this.#n(this.length+a),n+=a}}};var Fe=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function di(e){if(e===null)return!1;let t,n=0,r=e.length,i=Fe;for(let o=0;o<r;o++)if(t=i.indexOf(e.charAt(o)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function gi(e){let t=e.replace(/[\r\n=]/g,""),n=t.length,r=Fe,i=[],o=0;for(let s=0;s<n;s++)s%4===0&&s&&(i.push(o>>16&255),i.push(o>>8&255),i.push(o&255)),o=o<<6|r.indexOf(t.charAt(s));let a=n%4*6;return a===0?(i.push(o>>16&255),i.push(o>>8&255),i.push(o&255)):a===18?(i.push(o>>10&255),i.push(o>>2&255)):a===12&&i.push(o>>4&255),new le(new Uint8Array(i))}function hi(e){let t=e.length,n=Fe,r="",i=0;for(let a=0;a<t;a++)a%3===0&&a&&(r+=n[i>>18&63],r+=n[i>>12&63],r+=n[i>>6&63],r+=n[i&63]),i=(i<<8)+e[a];let o=t%3;return o===0?(r+=n[i>>18&63],r+=n[i>>12&63],r+=n[i>>6&63],r+=n[i&63]):o===2?(r+=n[i>>10&63],r+=n[i>>4&63],r+=n[i<<2&63],r+=n[64]):o===1&&(r+=n[i>>2&63],r+=n[i<<4&63],r+=n[64],r+=n[64]),r}function yi(e){if(typeof e?.readSync!="function")return!1;let t=new le;try{return 0>t.readFromSync(e)}catch{return!1}finally{t.reset()}}var Ie=new y("tag:yaml.org,2002:binary",{construct:gi,kind:"scalar",predicate:yi,represent:hi,resolve:di});function xi(e){let t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function bi(e){return e==="true"||e==="True"||e==="TRUE"}var _e=new y("tag:yaml.org,2002:bool",{construct:bi,defaultStyle:"lowercase",kind:"scalar",predicate:gt,represent:{lowercase(e){return e?"true":"false"},uppercase(e){return e?"TRUE":"FALSE"},camelcase(e){return e?"True":"False"}},resolve:xi});var wi=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Pi(e){return!(!wi.test(e)||e[e.length-1]==="_")}function Ai(e){let t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,r=[];if("+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf")return n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(t===".nan")return NaN;if(t.indexOf(":")>=0){t.split(":").forEach(a=>{r.unshift(parseFloat(a))});let i=0,o=1;return r.forEach(a=>{i+=a*o,o*=60}),n*i}return n*parseFloat(t)}var vi=/^[-+]?[0-9]+e/;function Ti(e,t){if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(ae(e))return"-0.0";let n=e.toString(10);return vi.test(n)?n.replace("e",".e"):n}function Ci(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||ae(e))}var De=new y("tag:yaml.org,2002:float",{construct:Ai,defaultStyle:"lowercase",kind:"scalar",predicate:Ci,represent:Ti,resolve:Pi});function bt(e){let t=new Function(`return ${e}`)();if(!(t instanceof Function))throw new TypeError(`Expected function but got ${typeof t}: ${e}`);return t}var Si=new y("tag:yaml.org,2002:js/function",{kind:"scalar",resolve(e){if(e===null)return!1;try{return bt(`${e}`),!0}catch{return!1}},construct(e){return bt(e)},predicate(e){return e instanceof Function},represent(e){return e.toString()}});function ki(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Mi(e){return 48<=e&&e<=55}function Ei(e){return 48<=e&&e<=57}function Li(e){let t=e.length,n=0,r=!1;if(!t)return!1;let i=e[n];if((i==="-"||i==="+")&&(i=e[++n]),i==="0"){if(n+1===t)return!0;if(i=e[++n],i==="b"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!ki(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}for(;n<t;n++)if(i=e[n],i!=="_"){if(!Mi(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="_")return!1;for(;n<t;n++)if(i=e[n],i!=="_"){if(i===":")break;if(!Ei(e.charCodeAt(n)))return!1;r=!0}return!r||i==="_"?!1:i!==":"?!0:/^(:[0-5]?[0-9])+$/.test(e.slice(n))}function Ni(e){let t=e,n=[];t.indexOf("_")!==-1&&(t=t.replace(/_/g,""));let r=1,i=t[0];if((i==="-"||i==="+")&&(i==="-"&&(r=-1),t=t.slice(1),i=t[0]),t==="0")return 0;if(i==="0")return t[1]==="b"?r*parseInt(t.slice(2),2):t[1]==="x"?r*parseInt(t,16):r*parseInt(t,8);if(t.indexOf(":")!==-1){t.split(":").forEach(s=>{n.unshift(parseInt(s,10))});let o=0,a=1;return n.forEach(s=>{o+=s*a,a*=60}),r*o}return r*parseInt(t,10)}function Oi(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!ae(e)}var Ue=new y("tag:yaml.org,2002:int",{construct:Ni,defaultStyle:"decimal",kind:"scalar",predicate:Oi,represent:{binary(e){return e>=0?`0b${e.toString(2)}`:`-0b${e.toString(2).slice(1)}`},octal(e){return e>=0?`0${e.toString(8)}`:`-0${e.toString(8).slice(1)}`},decimal(e){return e.toString(10)},hexadecimal(e){return e>=0?`0x${e.toString(16).toUpperCase()}`:`-0x${e.toString(16).toUpperCase().slice(1)}`}},resolve:Li,styleAliases:{binary:[2,"bin"],decimal:[10,"dec"],hexadecimal:[16,"hex"],octal:[8,"oct"]}});var je=new y("tag:yaml.org,2002:map",{construct(e){return e!==null?e:{}},kind:"mapping"});function Ri(e){return e==="<<"||e===null}var Be=new y("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Ri});function $i(e){let t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function Fi(){return null}function Ii(e){return e===null}var Ye=new y("tag:yaml.org,2002:null",{construct:Fi,defaultStyle:"lowercase",kind:"scalar",predicate:Ii,represent:{canonical(){return"~"},lowercase(){return"null"},uppercase(){return"NULL"},camelcase(){return"Null"}},resolve:$i});var{hasOwn:_i}=Object,Di=Object.prototype.toString;function Ui(e){let t=[],n="",r=!1;for(let i of e){if(r=!1,Di.call(i)!=="[object Object]")return!1;for(n in i)if(_i(i,n))if(!r)r=!0;else return!1;if(!r)return!1;if(t.indexOf(n)===-1)t.push(n);else return!1}return!0}function ji(e){return e!==null?e:[]}var He=new y("tag:yaml.org,2002:omap",{construct:ji,kind:"sequence",resolve:Ui});var Bi=Object.prototype.toString;function Yi(e){let t=Array.from({length:e.length});for(let n=0;n<e.length;n++){let r=e[n];if(Bi.call(r)!=="[object Object]")return!1;let i=Object.keys(r);if(i.length!==1)return!1;t[n]=[i[0],r[i[0]]]}return!0}function Hi(e){if(e===null)return[];let t=Array.from({length:e.length});for(let n=0;n<e.length;n+=1){let r=e[n],i=Object.keys(r);t[n]=[i[0],r[i[0]]]}return t}var qe=new y("tag:yaml.org,2002:pairs",{construct:Hi,kind:"sequence",resolve:Yi});var We=/^\/(?<regexp>[\s\S]+)\/(?<modifiers>[gismuy]*)$/,Qe=new y("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve(e){if(e===null||!e.length)return!1;let t=`${e}`;if(t.charAt(0)==="/"){if(!We.test(e))return!1;let n=[...t.match(We)?.groups?.modifiers??""];if(new Set(n).size<n.length)return!1}return!0},construct(e){let{regexp:t=`${e}`,modifiers:n=""}=`${e}`.match(We)?.groups??{};return new RegExp(t,n)},predicate(e){return e instanceof RegExp},represent(e){return e.toString()}});var Ve=new y("tag:yaml.org,2002:seq",{construct(e){return e!==null?e:[]},kind:"sequence"});var{hasOwn:qi}=Object;function Wi(e){if(e===null)return!0;for(let t in e)if(qi(e,t)&&e[t]!==null)return!1;return!0}function Qi(e){return e!==null?e:{}}var Ge=new y("tag:yaml.org,2002:set",{construct:Qi,kind:"mapping",resolve:Wi});var Ke=new y("tag:yaml.org,2002:str",{construct(e){return e!==null?e:""},kind:"scalar"});var wt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Pt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Vi(e){return e===null?!1:wt.exec(e)!==null||Pt.exec(e)!==null}function Gi(e){let t=wt.exec(e);if(t===null&&(t=Pt.exec(e)),t===null)throw new Error("Date resolve error");let n=+t[1],r=+t[2]-1,i=+t[3];if(!t[4])return new Date(Date.UTC(n,r,i));let o=+t[4],a=+t[5],s=+t[6],l=0;if(t[7]){let f=t[7].slice(0,3);for(;f.length<3;)f+="0";l=+f}let u=null;if(t[9]){let f=+t[10],h=+(t[11]||0);u=(f*60+h)*6e4,t[9]==="-"&&(u=-u)}let p=new Date(Date.UTC(n,r,i,o,a,s,l));return u&&p.setTime(p.getTime()-u),p}function Ki(e){return e.toISOString()}var ze=new y("tag:yaml.org,2002:timestamp",{construct:Gi,instanceOf:Date,kind:"scalar",represent:Ki,resolve:Vi});var Xe=new y("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve(){return!0},construct(){},predicate(e){return typeof e>"u"},represent(){return""}});var Ze=new M({explicit:[Ke,Ve,je]});var Je=new M({implicit:[Ye,_e,Ue,De],include:[Ze]});var et=new M({include:[Je]});var ce=new M({explicit:[Ie,He,qe,Ge],implicit:[ze,Be],include:[et]});var zi=new M({explicit:[Qe,Xe],include:[ce]});var J=class{constructor(t=ce){this.schema=t}};var he=class extends J{constructor(n,{filename:r,schema:i,onWarning:o,legacy:a=!1,json:s=!1,listener:l=null}){super(i);this.input=n;this.documents=[];this.lineIndent=0;this.lineStart=0;this.position=0;this.line=0;this.result="";this.filename=r,this.onWarning=o,this.legacy=a,this.json=s,this.listener=l,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=n.length}};var{hasOwn:Y}=Object,ye=1,Mt=2,Et=3,xe=4,tt=1,Xi=2,At=3,Zi=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Ji=/[\x85\u2028\u2029]/,eo=/[,\[\]\{\}]/,Lt=/^(?:!|!!|![a-z\-]+!)$/i,Nt=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function vt(e){return Object.prototype.toString.call(e)}function $(e){return e===10||e===13}function Q(e){return e===9||e===32}function E(e){return e===9||e===32||e===10||e===13}function ee(e){return e===44||e===91||e===93||e===123||e===125}function to(e){if(48<=e&&e<=57)return e-48;let t=e|32;return 97<=t&&t<=102?t-97+10:-1}function no(e){return e===120?2:e===117?4:e===85?8:0}function ro(e){return 48<=e&&e<=57?e-48:-1}function Tt(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"\x85":e===95?"\xA0":e===76?"\u2028":e===80?"\u2029":""}function io(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var Ot=Array.from({length:256}),Rt=Array.from({length:256});for(let e=0;e<256;e++)Ot[e]=Tt(e)?1:0,Rt[e]=Tt(e);function $t(e,t){return new N(t,new de(e.filename,e.input,e.position,e.line,e.position-e.lineStart))}function d(e,t){throw $t(e,t)}function be(e,t){e.onWarning&&e.onWarning.call(null,$t(e,t))}var Ct={YAML(e,t,...n){if(e.version!==null)return d(e,"duplication of %YAML directive");if(n.length!==1)return d(e,"YAML directive accepts exactly one argument");let r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]);if(r===null)return d(e,"ill-formed argument of the YAML directive");let i=parseInt(r[1],10),o=parseInt(r[2],10);if(i!==1)return d(e,"unacceptable YAML version of the document");if(e.version=n[0],e.checkLineBreaks=o<2,o!==1&&o!==2)return be(e,"unsupported YAML version of the document")},TAG(e,t,...n){if(n.length!==2)return d(e,"TAG directive accepts exactly two arguments");let r=n[0],i=n[1];if(!Lt.test(r))return d(e,"ill-formed tag handle (first argument) of the TAG directive");if(e.tagMap&&Y(e.tagMap,r))return d(e,`there is a previously declared suffix for "${r}" tag handle`);if(!Nt.test(i))return d(e,"ill-formed tag prefix (second argument) of the TAG directive");typeof e.tagMap>"u"&&(e.tagMap=Object.create(null)),e.tagMap[r]=i}};function B(e,t,n,r){let i;if(t<n){if(i=e.input.slice(t,n),r)for(let o=0,a=i.length;o<a;o++){let s=i.charCodeAt(o);if(!(s===9||32<=s&&s<=1114111))return d(e,"expected valid JSON character")}else if(Zi.test(i))return d(e,"the stream contains non-printable characters");e.result+=i}}function St(e,t,n,r){if(!ht(n))return d(e,"cannot merge mappings; the provided source object is unacceptable");let i=Object.keys(n);for(let o=0,a=i.length;o<a;o++){let s=i[o];Y(t,s)||(Object.defineProperty(t,s,{value:n[s],writable:!0,enumerable:!0,configurable:!0}),r[s]=!0)}}function te(e,t,n,r,i,o,a,s){if(Array.isArray(i)){i=Array.prototype.slice.call(i);for(let l=0,u=i.length;l<u;l++){if(Array.isArray(i[l]))return d(e,"nested arrays are not supported inside keys");typeof i=="object"&&vt(i[l])==="[object Object]"&&(i[l]="[object Object]")}}if(typeof i=="object"&&vt(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(let l=0,u=o.length;l<u;l++)St(e,t,o[l],n);else St(e,t,o,n);else{if(!e.json&&!Y(n,i)&&Y(t,i))return e.line=a||e.line,e.position=s||e.position,d(e,"duplicated mapping key");Object.defineProperty(t,i,{value:o,writable:!0,enumerable:!0,configurable:!0}),delete n[i]}return t}function nt(e){let t=e.input.charCodeAt(e.position);if(t===10)e.position++;else if(t===13)e.position++,e.input.charCodeAt(e.position)===10&&e.position++;else return d(e,"a line break is expected");e.line+=1,e.lineStart=e.position}function b(e,t,n){let r=0,i=e.input.charCodeAt(e.position);for(;i!==0;){for(;Q(i);)i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if($(i))for(nt(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&be(e,"deficient indentation"),r}function we(e){let t=e.position,n=e.input.charCodeAt(t);return!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||E(n)))}function rt(e,t){t===1?e.result+=" ":t>1&&(e.result+=k(`
`,t-1))}function oo(e,t,n){let r=e.kind,i=e.result,o=e.input.charCodeAt(e.position);if(E(o)||ee(o)||o===35||o===38||o===42||o===33||o===124||o===62||o===39||o===34||o===37||o===64||o===96)return!1;let a;if((o===63||o===45)&&(a=e.input.charCodeAt(e.position+1),E(a)||n&&ee(a)))return!1;e.kind="scalar",e.result="";let s,l=s=e.position,u=!1,p=0;for(;o!==0;){if(o===58){if(a=e.input.charCodeAt(e.position+1),E(a)||n&&ee(a))break}else if(o===35){let f=e.input.charCodeAt(e.position-1);if(E(f))break}else{if(e.position===e.lineStart&&we(e)||n&&ee(o))break;if($(o)){p=e.line;let f=e.lineStart,h=e.lineIndent;if(b(e,!1,-1),e.lineIndent>=t){u=!0,o=e.input.charCodeAt(e.position);continue}else{e.position=s,e.line=p,e.lineStart=f,e.lineIndent=h;break}}}u&&(B(e,l,s,!1),rt(e,e.line-p),l=s=e.position,u=!1),Q(o)||(s=e.position+1),o=e.input.charCodeAt(++e.position)}return B(e,l,s,!1),e.result?!0:(e.kind=r,e.result=i,!1)}function ao(e,t){let n,r,i;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(B(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,i=e.position;else return!0;else if($(n))B(e,r,i,!0),rt(e,b(e,!1,t)),r=i=e.position;else{if(e.position===e.lineStart&&we(e))return d(e,"unexpected end of the document within a single quoted scalar");e.position++,i=e.position}return d(e,"unexpected end of the stream within a single quoted scalar")}function so(e,t){let n=e.input.charCodeAt(e.position);if(n!==34)return!1;e.kind="scalar",e.result="",e.position++;let r,i=r=e.position,o;for(;(n=e.input.charCodeAt(e.position))!==0;){if(n===34)return B(e,i,e.position,!0),e.position++,!0;if(n===92){if(B(e,i,e.position,!0),n=e.input.charCodeAt(++e.position),$(n))b(e,!1,t);else if(n<256&&Ot[n])e.result+=Rt[n],e.position++;else if((o=no(n))>0){let a=o,s=0;for(;a>0;a--)if(n=e.input.charCodeAt(++e.position),(o=to(n))>=0)s=(s<<4)+o;else return d(e,"expected hexadecimal character");e.result+=io(s),e.position++}else return d(e,"unknown escape sequence");i=r=e.position}else if($(n))B(e,i,r,!0),rt(e,b(e,!1,t)),i=r=e.position;else{if(e.position===e.lineStart&&we(e))return d(e,"unexpected end of the document within a double quoted scalar");e.position++,r=e.position}}return d(e,"unexpected end of the stream within a double quoted scalar")}function lo(e,t){let n=e.input.charCodeAt(e.position),r,i=!0,o={};if(n===91)r=93,i=!1,o=[];else if(n===123)r=125;else return!1;e.anchor!==null&&typeof e.anchor<"u"&&typeof e.anchorMap<"u"&&(e.anchorMap[e.anchor]=o),n=e.input.charCodeAt(++e.position);let a=e.tag,s=e.anchor,l=!0,u,p,f=p=u=null,h,A=h=!1,x=0,C=0,w=Object.create(null);for(;n!==0;){if(b(e,!0,t),n=e.input.charCodeAt(e.position),n===r)return e.position++,e.tag=a,e.anchor=s,e.kind=i?"mapping":"sequence",e.result=o,!0;if(!l)return d(e,"missed comma between flow collection entries");f=p=u=null,A=h=!1,n===63&&(x=e.input.charCodeAt(e.position+1),E(x)&&(A=h=!0,e.position++,b(e,!0,t))),C=e.line,ne(e,t,ye,!1,!0),f=e.tag||null,p=e.result,b(e,!0,t),n=e.input.charCodeAt(e.position),(h||e.line===C)&&n===58&&(A=!0,n=e.input.charCodeAt(++e.position),b(e,!0,t),ne(e,t,ye,!1,!0),u=e.result),i?te(e,o,w,f,p,u):A?o.push(te(e,null,w,f,p,u)):o.push(p),b(e,!0,t),n=e.input.charCodeAt(e.position),n===44?(l=!0,n=e.input.charCodeAt(++e.position)):l=!1}return d(e,"unexpected end of the stream within a flow collection")}function co(e,t){let n=tt,r=!1,i=!1,o=t,a=0,s=!1,l=e.input.charCodeAt(e.position),u=!1;if(l===124)u=!1;else if(l===62)u=!0;else return!1;e.kind="scalar",e.result="";let p=0;for(;l!==0;)if(l=e.input.charCodeAt(++e.position),l===43||l===45)if(tt===n)n=l===43?At:Xi;else return d(e,"repeat of a chomping mode identifier");else if((p=ro(l))>=0){if(p===0)return d(e,"bad explicit indentation width of a block scalar; it cannot be less than one");if(!i)o=t+p-1,i=!0;else return d(e,"repeat of an indentation width identifier")}else break;if(Q(l)){do l=e.input.charCodeAt(++e.position);while(Q(l));if(l===35)do l=e.input.charCodeAt(++e.position);while(!$(l)&&l!==0)}for(;l!==0;){for(nt(e),e.lineIndent=0,l=e.input.charCodeAt(e.position);(!i||e.lineIndent<o)&&l===32;)e.lineIndent++,l=e.input.charCodeAt(++e.position);if(!i&&e.lineIndent>o&&(o=e.lineIndent),$(l)){a++;continue}if(e.lineIndent<o){n===At?e.result+=k(`
`,r?1+a:a):n===tt&&r&&(e.result+=`
`);break}u?Q(l)?(s=!0,e.result+=k(`
`,r?1+a:a)):s?(s=!1,e.result+=k(`
`,a+1)):a===0?r&&(e.result+=" "):e.result+=k(`
`,a):e.result+=k(`
`,r?1+a:a),r=!0,i=!0,a=0;let f=e.position;for(;!$(l)&&l!==0;)l=e.input.charCodeAt(++e.position);B(e,f,e.position,!1)}return!0}function kt(e,t){let n,r,i=!1,o,a=e.tag,s=e.anchor,l=[];for(e.anchor!==null&&typeof e.anchor<"u"&&typeof e.anchorMap<"u"&&(e.anchorMap[e.anchor]=l),o=e.input.charCodeAt(e.position);o!==0&&!(o!==45||(r=e.input.charCodeAt(e.position+1),!E(r)));){if(i=!0,e.position++,b(e,!0,-1)&&e.lineIndent<=t){l.push(null),o=e.input.charCodeAt(e.position);continue}if(n=e.line,ne(e,t,Et,!1,!0),l.push(e.result),b(e,!0,-1),o=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&o!==0)return d(e,"bad indentation of a sequence entry");if(e.lineIndent<t)break}return i?(e.tag=a,e.anchor=s,e.kind="sequence",e.result=l,!0):!1}function uo(e,t,n){let r=e.tag,i=e.anchor,o={},a=Object.create(null),s,l=!1,u,p,f=null,h=null,A=null,x=!1,C=!1,w;for(e.anchor!==null&&typeof e.anchor<"u"&&typeof e.anchorMap<"u"&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(e.position);w!==0;){if(s=e.input.charCodeAt(e.position+1),u=e.line,p=e.position,(w===63||w===58)&&E(s)){if(w===63)x&&(te(e,o,a,f,h,null),f=h=A=null),C=!0,x=!0,l=!0;else if(x)x=!1,l=!0;else return d(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line");e.position+=1,w=s}else if(ne(e,n,Mt,!1,!0))if(e.line===u){for(w=e.input.charCodeAt(e.position);Q(w);)w=e.input.charCodeAt(++e.position);if(w===58){if(w=e.input.charCodeAt(++e.position),!E(w))return d(e,"a whitespace character is expected after the key-value separator within a block mapping");x&&(te(e,o,a,f,h,null),f=h=A=null),C=!0,x=!1,l=!1,f=e.tag,h=e.result}else return C?d(e,"can not read an implicit mapping pair; a colon is missed"):(e.tag=r,e.anchor=i,!0)}else return C?d(e,"can not read a block mapping entry; a multiline key may not be an implicit key"):(e.tag=r,e.anchor=i,!0);else break;if((e.line===u||e.lineIndent>t)&&(ne(e,t,xe,!0,l)&&(x?h=e.result:A=e.result),x||(te(e,o,a,f,h,A,u,p),f=h=A=null),b(e,!0,-1),w=e.input.charCodeAt(e.position)),e.lineIndent>t&&w!==0)return d(e,"bad indentation of a mapping entry");if(e.lineIndent<t)break}return x&&te(e,o,a,f,h,null),C&&(e.tag=r,e.anchor=i,e.kind="mapping",e.result=o),C}function po(e){let t,n=!1,r=!1,i="",o,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null)return d(e,"duplication of a tag property");if(a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,i="!!",a=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);if(e.position<e.length)o=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position);else return d(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!E(a);){if(a===33){if(r)return d(e,"tag suffix cannot contain exclamation marks");if(i=e.input.slice(t-1,e.position+1),!Lt.test(i))return d(e,"named tag handle cannot contain such characters");r=!0,t=e.position+1}a=e.input.charCodeAt(++e.position)}if(o=e.input.slice(t,e.position),eo.test(o))return d(e,"tag suffix cannot contain flow indicator characters")}if(o&&!Nt.test(o))return d(e,`tag name cannot contain such characters: ${o}`);if(n)e.tag=o;else if(typeof e.tagMap<"u"&&Y(e.tagMap,i))e.tag=e.tagMap[i]+o;else if(i==="!")e.tag=`!${o}`;else if(i==="!!")e.tag=`tag:yaml.org,2002:${o}`;else return d(e,`undeclared tag handle "${i}"`);return!0}function mo(e){let t=e.input.charCodeAt(e.position);if(t!==38)return!1;if(e.anchor!==null)return d(e,"duplication of an anchor property");t=e.input.charCodeAt(++e.position);let n=e.position;for(;t!==0&&!E(t)&&!ee(t);)t=e.input.charCodeAt(++e.position);return e.position===n?d(e,"name of an anchor node must contain at least one character"):(e.anchor=e.input.slice(n,e.position),!0)}function fo(e){let t=e.input.charCodeAt(e.position);if(t!==42)return!1;t=e.input.charCodeAt(++e.position);let n=e.position;for(;t!==0&&!E(t)&&!ee(t);)t=e.input.charCodeAt(++e.position);if(e.position===n)return d(e,"name of an alias node must contain at least one character");let r=e.input.slice(n,e.position);return typeof e.anchorMap<"u"&&!Y(e.anchorMap,r)?d(e,`unidentified alias "${r}"`):(typeof e.anchorMap<"u"&&(e.result=e.anchorMap[r]),b(e,!0,-1),!0)}function ne(e,t,n,r,i){let o,a,s=1,l=!1,u=!1,p,f,h;e.listener&&e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null;let A=o=a=xe===n||Et===n;if(r&&b(e,!0,-1)&&(l=!0,e.lineIndent>t?s=1:e.lineIndent===t?s=0:e.lineIndent<t&&(s=-1)),s===1)for(;po(e)||mo(e);)b(e,!0,-1)?(l=!0,a=A,e.lineIndent>t?s=1:e.lineIndent===t?s=0:e.lineIndent<t&&(s=-1)):a=!1;if(a&&(a=l||i),s===1||xe===n)if(f=ye===n||Mt===n?t:t+1,h=e.position-e.lineStart,s===1)if(a&&(kt(e,h)||uo(e,h,f))||lo(e,f))u=!0;else{if(o&&co(e,f)||ao(e,f)||so(e,f))u=!0;else if(fo(e)){if(u=!0,e.tag!==null||e.anchor!==null)return d(e,"alias node should not have Any properties")}else oo(e,f,ye===n)&&(u=!0,e.tag===null&&(e.tag="?"));e.anchor!==null&&typeof e.anchorMap<"u"&&(e.anchorMap[e.anchor]=e.result)}else s===0&&(u=a&&kt(e,h));if(e.tag!==null&&e.tag!=="!")if(e.tag==="?"){for(let x=0,C=e.implicitTypes.length;x<C;x++)if(p=e.implicitTypes[x],p.resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,e.anchor!==null&&typeof e.anchorMap<"u"&&(e.anchorMap[e.anchor]=e.result);break}}else if(Y(e.typeMap[e.kind||"fallback"],e.tag)){if(p=e.typeMap[e.kind||"fallback"][e.tag],e.result!==null&&p.kind!==e.kind)return d(e,`unacceptable node kind for !<${e.tag}> tag; it should be "${p.kind}", not "${e.kind}"`);if(p.resolve(e.result))e.result=p.construct(e.result),e.anchor!==null&&typeof e.anchorMap<"u"&&(e.anchorMap[e.anchor]=e.result);else return d(e,`cannot resolve a node with !<${e.tag}> explicit tag`)}else return d(e,`unknown tag !<${e.tag}>`);return e.listener&&e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function go(e){let t=e.position,n,r,i,o=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(b(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(o=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!E(a);)a=e.input.charCodeAt(++e.position);if(r=e.input.slice(n,e.position),i=[],r.length<1)return d(e,"directive name must not be less than one character in length");for(;a!==0;){for(;Q(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!$(a));break}if($(a))break;for(n=e.position;a!==0&&!E(a);)a=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}a!==0&&nt(e),Y(Ct,r)?Ct[r](e,r,...i):be(e,`unknown document directive "${r}"`)}if(b(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45)e.position+=3,b(e,!0,-1);else if(o)return d(e,"directives end mark is expected");if(ne(e,e.lineIndent-1,xe,!1,!0),b(e,!0,-1),e.checkLineBreaks&&Ji.test(e.input.slice(t,e.position))&&be(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&we(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,b(e,!0,-1));return}if(e.position<e.length-1)return d(e,"end of the stream or a document separator is expected")}function ho(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));let n=new he(e,t);for(n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)go(n);return n.documents}function Ft(e,t){let n=ho(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new N("expected a single document in the stream, but found more")}}function V(e,t){return Ft(e,t)}var{hasOwn:yo}=Object;function xo(e,t){if(typeof t>"u"||t===null)return{};let n,r={},i=Object.keys(t),o,a;for(let s=0,l=i.length;s<l;s+=1)o=i[s],a=String(t[o]),o.slice(0,2)==="!!"&&(o=`tag:yaml.org,2002:${o.slice(2)}`),n=e.compiledTypeMap.fallback[o],n&&typeof n.styleAliases<"u"&&yo(n.styleAliases,a)&&(a=n.styleAliases[a]),r[o]=a;return r}var Pe=class extends J{constructor({schema:n,indent:r=2,noArrayIndent:i=!1,skipInvalid:o=!1,flowLevel:a=-1,styles:s=null,sortKeys:l=!1,lineWidth:u=80,noRefs:p=!1,noCompatMode:f=!1,condenseFlow:h=!1}){super(n);this.tag=null;this.result="";this.duplicates=[];this.usedDuplicates=[];this.indent=Math.max(1,r),this.noArrayIndent=i,this.skipInvalid=o,this.flowLevel=a,this.styleMap=xo(this.schema,s),this.sortKeys=l,this.lineWidth=u,this.noRefs=p,this.noCompatMode=f,this.condenseFlow=h,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit}};var Ht=Object.prototype.toString,{hasOwn:bo}=Object,wo=9,ve=10,Po=32,Ao=33,vo=34,qt=35,To=37,Co=38,So=39,ko=42,Wt=44,Mo=45,Qt=58,Eo=62,Lo=63,No=64,Vt=91,Gt=93,Oo=96,Kt=123,Ro=124,zt=125,T={};T[0]="\\0";T[7]="\\a";T[8]="\\b";T[9]="\\t";T[10]="\\n";T[11]="\\v";T[12]="\\f";T[13]="\\r";T[27]="\\e";T[34]='\\"';T[92]="\\\\";T[133]="\\N";T[160]="\\_";T[8232]="\\L";T[8233]="\\P";var $o=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function It(e){let t=e.toString(16).toUpperCase(),n,r;if(e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new N("code point within a string may not be greater than 0xFFFFFFFF");return`\\${n}${k("0",r-t.length)}${t}`}function _t(e,t){let n=k(" ",t),r=e.length,i=0,o=-1,a="",s;for(;i<r;)o=e.indexOf(`
`,i),o===-1?(s=e.slice(i),i=r):(s=e.slice(i,o+1),i=o+1),s.length&&s!==`
`&&(a+=n),a+=s;return a}function it(e,t){return`
${k(" ",e.indent*t)}`}function Fo(e,t){let n;for(let r=0,i=e.implicitTypes.length;r<i;r+=1)if(n=e.implicitTypes[r],n.resolve(t))return!0;return!1}function Xt(e){return e===Po||e===wo}function ue(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==65279||65536<=e&&e<=1114111}function Dt(e){return ue(e)&&e!==65279&&e!==Wt&&e!==Vt&&e!==Gt&&e!==Kt&&e!==zt&&e!==Qt&&e!==qt}function Io(e){return ue(e)&&e!==65279&&!Xt(e)&&e!==Mo&&e!==Lo&&e!==Qt&&e!==Wt&&e!==Vt&&e!==Gt&&e!==Kt&&e!==zt&&e!==qt&&e!==Co&&e!==ko&&e!==Ao&&e!==Ro&&e!==Eo&&e!==So&&e!==vo&&e!==To&&e!==No&&e!==Oo}function Zt(e){return/^\n* /.test(e)}var Jt=1,en=2,tn=3,nn=4,Ae=5;function _o(e,t,n,r,i){let o=r!==-1,a=!1,s=!1,l=-1,u=Io(e.charCodeAt(0))&&!Xt(e.charCodeAt(e.length-1)),p,f;if(t)for(f=0;f<e.length;f++){if(p=e.charCodeAt(f),!ue(p))return Ae;u=u&&Dt(p)}else{for(f=0;f<e.length;f++){if(p=e.charCodeAt(f),p===ve)a=!0,o&&(s=s||f-l-1>r&&e[l+1]!==" ",l=f);else if(!ue(p))return Ae;u=u&&Dt(p)}s=s||o&&f-l-1>r&&e[l+1]!==" "}return!a&&!s?u&&!i(e)?Jt:en:n>9&&Zt(e)?Ae:s?nn:tn}function Ut(e,t){if(e===""||e[0]===" ")return e;let n=/ [^ ]/g,r,i=0,o,a=0,s=0,l="";for(;r=n.exec(e);)s=r.index,s-i>t&&(o=a>i?a:s,l+=`
${e.slice(i,o)}`,i=o+1),a=s;return l+=`
`,e.length-i>t&&a>i?l+=`${e.slice(i,a)}
${e.slice(a+1)}`:l+=e.slice(i),l.slice(1)}function jt(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function Do(e,t){let n=/(\n+)([^\n]*)/g,r=(()=>{let s=e.indexOf(`
`);return s=s!==-1?s:e.length,n.lastIndex=s,Ut(e.slice(0,s),t)})(),i=e[0]===`
`||e[0]===" ",o,a;for(;a=n.exec(e);){let s=a[1],l=a[2];o=l[0]===" ",r+=s+(!i&&!o&&l!==""?`
`:"")+Ut(l,t),i=o}return r}function Uo(e){let t="",n,r,i;for(let o=0;o<e.length;o++){if(n=e.charCodeAt(o),n>=55296&&n<=56319&&(r=e.charCodeAt(o+1),r>=56320&&r<=57343)){t+=It((n-55296)*1024+r-56320+65536),o++;continue}i=T[n],t+=!i&&ue(n)?e[o]:i||It(n)}return t}function Bt(e,t){let n=Zt(e)?String(t):"",r=e[e.length-1]===`
`,o=r&&(e[e.length-2]===`
`||e===`
`)?"+":r?"":"-";return`${n}${o}
`}function jo(e,t,n,r){e.dump=(()=>{if(t.length===0)return"''";if(!e.noCompatMode&&$o.indexOf(t)!==-1)return`'${t}'`;let i=e.indent*Math.max(1,n),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),a=r||e.flowLevel>-1&&n>=e.flowLevel;function s(l){return Fo(e,l)}switch(_o(t,a,e.indent,o,s)){case Jt:return t;case en:return`'${t.replace(/'/g,"''")}'`;case tn:return`|${Bt(t,e.indent)}${jt(_t(t,i))}`;case nn:return`>${Bt(t,e.indent)}${jt(_t(Do(t,o),i))}`;case Ae:return`"${Uo(t)}"`;default:throw new N("impossible error: invalid scalar style")}})()}function Bo(e,t,n){let r="",i=e.tag;for(let o=0,a=n.length;o<a;o+=1)G(e,t,n[o],!1,!1)&&(o!==0&&(r+=`,${e.condenseFlow?"":" "}`),r+=e.dump);e.tag=i,e.dump=`[${r}]`}function Yo(e,t,n,r=!1){let i="",o=e.tag;for(let a=0,s=n.length;a<s;a+=1)G(e,t+1,n[a],!0,!0)&&((!r||a!==0)&&(i+=it(e,t)),e.dump&&ve===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=o,e.dump=i||"[]"}function Ho(e,t,n){let r="",i=e.tag,o=Object.keys(n),a,s,l;for(let u=0,p=o.length;u<p;u+=1)a=e.condenseFlow?'"':"",u!==0&&(a+=", "),s=o[u],l=n[s],G(e,t,s,!1,!1)&&(e.dump.length>1024&&(a+="? "),a+=`${e.dump}${e.condenseFlow?'"':""}:${e.condenseFlow?"":" "}`,G(e,t,l,!1,!1)&&(a+=e.dump,r+=a));e.tag=i,e.dump=`{${r}}`}function qo(e,t,n,r=!1){let i=e.tag,o=Object.keys(n),a="";if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new N("sortKeys must be a boolean or a function");let s="",l,u,p;for(let f=0,h=o.length;f<h;f+=1)s="",(!r||f!==0)&&(s+=it(e,t)),l=o[f],u=n[l],G(e,t+1,l,!0,!0,!0)&&(p=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,p&&(e.dump&&ve===e.dump.charCodeAt(0)?s+="?":s+="? "),s+=e.dump,p&&(s+=it(e,t)),G(e,t+1,u,!0,p)&&(e.dump&&ve===e.dump.charCodeAt(0)?s+=":":s+=": ",s+=e.dump,a+=s));e.tag=i,e.dump=a||"{}"}function Yt(e,t,n=!1){let r=n?e.explicitTypes:e.implicitTypes,i,o,a;for(let s=0,l=r.length;s<l;s+=1)if(i=r[s],(i.instanceOf||i.predicate)&&(!i.instanceOf||typeof t=="object"&&t instanceof i.instanceOf)&&(!i.predicate||i.predicate(t))){if(e.tag=n?i.tag:"?",i.represent){if(o=e.styleMap[i.tag]||i.defaultStyle,Ht.call(i.represent)==="[object Function]")a=i.represent(t,o);else if(bo(i.represent,o))a=i.represent[o](t,o);else throw new N(`!<${i.tag}> tag resolver accepts not "${o}" style`);e.dump=a}return!0}return!1}function G(e,t,n,r,i,o=!1){e.tag=null,e.dump=n,Yt(e,n,!1)||Yt(e,n,!0);let a=Ht.call(e.dump);r&&(r=e.flowLevel<0||e.flowLevel>t);let s=a==="[object Object]"||a==="[object Array]",l=-1,u=!1;if(s&&(l=e.duplicates.indexOf(n),u=l!==-1),(e.tag!==null&&e.tag!=="?"||u||e.indent!==2&&t>0)&&(i=!1),u&&e.usedDuplicates[l])e.dump=`*ref_${l}`;else{if(s&&u&&!e.usedDuplicates[l]&&(e.usedDuplicates[l]=!0),a==="[object Object]")r&&Object.keys(e.dump).length!==0?(qo(e,t,e.dump,i),u&&(e.dump=`&ref_${l}${e.dump}`)):(Ho(e,t,e.dump),u&&(e.dump=`&ref_${l} ${e.dump}`));else if(a==="[object Array]"){let p=e.noArrayIndent&&t>0?t-1:t;r&&e.dump.length!==0?(Yo(e,p,e.dump,i),u&&(e.dump=`&ref_${l}${e.dump}`)):(Bo(e,p,e.dump),u&&(e.dump=`&ref_${l} ${e.dump}`))}else if(a==="[object String]")e.tag!=="?"&&jo(e,e.dump,t,o);else{if(e.skipInvalid)return!1;throw new N(`unacceptable kind of an object to dump ${a}`)}e.tag!==null&&e.tag!=="?"&&(e.dump=`!<${e.tag}> ${e.dump}`)}return!0}function ot(e,t,n){if(e!==null&&typeof e=="object"){let r=t.indexOf(e);if(r!==-1)n.indexOf(r)===-1&&n.push(r);else if(t.push(e),Array.isArray(e))for(let i=0,o=e.length;i<o;i+=1)ot(e[i],t,n);else{let i=Object.keys(e);for(let o=0,a=i.length;o<a;o+=1)ot(e[i[o]],t,n)}}}function Wo(e,t){let n=[],r=[];ot(e,n,r);let i=r.length;for(let o=0;o<i;o+=1)t.duplicates.push(n[r[o]]);t.usedDuplicates=Array.from({length:i})}function rn(e,t){t=t||{};let n=new Pe(t);return n.noRefs||Wo(e,n),G(n,0,e,!0,!0)?`${n.dump}
`:""}function pe(e,t){return rn(e,t)}function re(e,t=[]){let n={};return D(e),F(e,r=>{if(r.type==="Hashtag"){if(r.parent&&r.parent.type==="Paragraph"){let u=r.children[0].text.substring(1);n.tags||(n.tags=[]),Array.isArray(n.tags)&&!n.tags.includes(u)&&n.tags.push(u)}return}if(r.type==="FrontMatter"){let u=r.children[1].children[0],p=S(u);try{let f=V(p),h={...f};if(n={...n,...f},t.length>0){let A=!1;for(let x of t)x in h&&(delete h[x],A=!0);A&&(u.text=pe(h))}if(Object.keys(h).length===0)return null}catch(f){console.error("Could not parse frontmatter",f)}}if(r.type!=="FencedCode")return;let i=j(r,"CodeInfo");if(!i||i.children[0].text!=="meta")return;let o=j(r,"CodeText");if(!o)return;let a=o.children[0].text,s=V(a),l={...s};if(n={...n,...s},t.length>0){let u=!1;for(let p of t)p in l&&(delete l[p],u=!0);u&&(o.children[0].text=pe(l).trim())}if(Object.keys(l).length===0)return null}),n.name&&(n.displayName=n.name,delete n.name),n}async function on({name:e,tree:t}){let n=[],r=re(t);if(Object.keys(r).length>0){for(let i in r)i.startsWith("$")&&delete r[i];await P.set(e,"meta:",r)}z(t,i=>i.type==="WikiLinkPage").forEach(i=>{let o=i.children[0].text;o.includes("@")&&(o=o.split("@")[0]),n.push({key:`pl:${o}:${i.from}`,value:e})}),await P.batchSet(e,n)}async function an({query:e}){return I(e,await g.listPages())}async function sn({query:e,pageName:t}){let n=[];for(let{value:r,key:i}of await P.queryPrefix(`pl:${t}:`)){let[,,o]=i.split(":");n.push({name:r,pos:o})}return I(e,n)}async function ln(){let e=await c.getCurrentPage();!await c.confirm(`Are you sure you would like to delete ${e}?`)||(console.log("Navigating to index page"),await c.navigate(""),console.log("Deleting page from space"),await g.deletePage(e))}async function cn(e){console.log("Got a target name",e.page);let t=await c.getCurrentPage(),n=await c.getCursor();console.log("Old name is",t);let r=e.page||await c.prompt(`Rename ${t} to:`,t);if(!r)return;if(console.log("New name",r),r.trim()===t.trim()){console.log("Name unchanged, exiting");return}try{throw await g.getPageMeta(r),new Error(`Page ${r} already exists, cannot rename to existing page.`)}catch(p){if(!p.message.includes("not found"))throw await c.flashNotification(p.message,"error"),p}let i=await Qo(t);console.log("All pages containing backlinks",i);let o=await c.getText();console.log("Writing new page to space");let a=await g.writePage(r,o);console.log("Navigating to new page"),await c.navigate(r,n,!0),(await g.getPageMeta(t)).lastModified!==a.lastModified&&(console.log("Deleting page from space"),await g.deletePage(t));let l=new Set;for(let p of i)l.add(p.page);let u=0;for(let p of l){if(p===t)continue;console.log("Now going to update links in",p);let f=await g.readPage(p);if(!f)continue;let h=await v.parseMarkdown(f);D(h),F(h,x=>{if(x.type==="WikiLinkPage"){let C=x.children[0].text;if(C===t)return x.children[0].text=r,u++,x;if(C.startsWith(`${t}@`)){let[,w]=C.split("@");return x.children[0].text=`${r}@${w}`,u++,x}}});let A=S(h);f!==A&&(console.log("Changes made, saving..."),await g.writePage(p,A))}await c.flashNotification(`Renamed page, and updated ${u} references`)}async function un(){let e=await g.listPages(),t="Untitled",n=1;for(;e.find(r=>r.name===t);)t=`Untitled ${n}`,n++;await c.navigate(t)}async function Qo(e){let t=await P.queryPrefix(`pl:${e}:`),n=[];for(let{key:r,value:i}of t){let o=r.split(":");n.push({page:i,pos:+o[o.length-1]})}return n}async function pn(){await c.flashNotification("Reindexing..."),await L.invokeFunction("server","reindexSpace"),await c.flashNotification("Reindexing done")}async function mn(e){let t=/\[\[([^\]@:]*)$/.exec(e.linePrefix);if(!t)return null;let n=await g.listPages();return{from:e.pos-t[1].length,options:n.map(r=>({label:r.name,boost:r.lastModified,type:"page"}))}}async function fn(){console.log("Clearing page index..."),await P.clearPageIndex(),console.log("Listing all pages");let e=await g.listPages(),t=0;for(let{name:n}of e){t++,console.log(`Indexing page ${t}/${e.length}: ${n}`);let r=await g.readPage(n),i=await v.parseMarkdown(r);await R.dispatchEvent("page:index",{name:n,tree:i})}console.log("Indexing completed!")}async function dn(e){await P.clearPageIndexForPage(e)}async function gn({name:e,text:t}){await R.dispatchEvent("page:index",{name:e,tree:await v.parseMarkdown(t)})}async function hn({query:e}){return I(e,await g.listAttachments())}async function yn(e){let t=/\{\[([^\]]*)$/.exec(e.linePrefix);if(!t)return null;let n=await L.listCommands();return{from:e.pos-t[1].length,options:Object.keys(n).map(r=>({label:r,type:"command"}))}}async function xn({name:e,tree:t}){let n=[];Z(t),U(t,"ListItem").forEach(i=>{if(!i.children||U(i,"Task").length>0)return;let o=[],a;for(let u of i.children.slice(1)){if(u.type==="OrderedList"||u.type==="BulletList"){a=S(u);break}o.push(u)}let l={name:o.map(S).join("").trim()};a&&(l.nested=a),U(i,"Hashtag").forEach(u=>{l.tags||(l.tags=[]),l.tags.push(u.children[0].text.substring(1))}),n.push({key:`it:${i.from}`,value:l})}),await P.batchSet(e,n)}async function bn({query:e}){let t=[];for(let{key:n,page:r,value:i}of await P.queryPrefix("it:")){let[,o]=n.split(":");t.push({...i,page:r,pos:+o})}return I(e,t)}async function wn(e,t=!1){if(!e)return;let n=r=>["WikiLink","Link","Image","URL","NakedURL","Link","CommandLink","PageRef"].includes(r.type);if(!(!n(e)&&(e=dt(e,n),!e)))switch(e.type){case"WikiLink":{let r=e.children[1].children[0].text,i;r.includes("@")&&([r,i]=r.split("@"),i.match(/^\d+$/)&&(i=+i)),r||(r=await c.getCurrentPage()),await c.navigate(r,i,!1,t);break}case"PageRef":{let r=e.children[0].text;await c.navigate(r.substring(2,r.length-2),0,!1,t);break}case"NakedURL":await c.openUrl(e.children[0].text);break;case"Image":case"Link":{let r=j(e,"URL");if(!r)return;let i=r.children[0].text;if(i.length<=1)return c.flashNotification("Empty link, ignoring","error");if(i.indexOf("://")===-1&&!i.startsWith("mailto:")){i=decodeURIComponent(i);let o=await g.readAttachment(i);return c.downloadFile(i,o)}else await c.openUrl(i);break}case"CommandLink":{let r=e.children[1].children[0].text;await L.invokeCommand(r);break}}}async function Pn(){let e=await v.parseMarkdown(await c.getText()),t=X(e,await c.getCursor());D(e),await wn(t)}async function An(e){if(e.altKey)return;let t=await v.parseMarkdown(await c.getText());D(t);let n=X(t,e.pos);await wn(n,e.ctrlKey||e.metaKey)}async function vn(e){await c.navigate(e.page)}async function Tn({name:e,tree:t}){Z(t);let n=new Set,{tags:r}=re(t);Array.isArray(r)&&r.forEach(i=>n.add(i)),U(t,"Hashtag").forEach(i=>{n.add(i.children[0].text.substring(1))}),await P.batchSet(e,[...n].map(i=>({key:`tag:${i}`,value:i})))}async function Cn(e){let t=/#[^#\s]+$/.exec(e.linePrefix);if(!t)return null;let n=t[0].substring(1),r=await P.queryPrefix(`tag:${n}`);return{from:e.pos-n.length,options:r.map(i=>({label:i.value,type:"tag"}))}}async function Sn({query:e}){let t=new Map;for(let{value:n}of await P.queryPrefix("tag:")){let r=t.get(n);r||(r=0),t.set(n,r+1)}return I(e,[...t.entries()].map(([n,r])=>({name:n,freq:r})))}async function kn({name:e,tree:t}){Z(t);let n=[];U(t,"NamedAnchor").forEach(r=>{let i=r.children[0].text.substring(1);n.push({key:`a:${e}:${i}`,value:""+r.from})}),await P.batchSet(e,n)}async function Mn(e){let t=/\[\[([^\]@:]*@[\w\.\-\/]*)$/.exec(e.linePrefix);if(!t)return null;let[n,r]=t[1].split("@");n||(n=await c.getCurrentPage());let i=await P.queryPrefix(`a:${n}:${r}`);return{from:e.pos-r.length,options:i.map(o=>({label:o.key.split(":")[2],type:"anchor"}))}}function H(e){function t(n){let r=String(n);return r.length===1&&(r="0"+r),r}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}async function at(e,t){let n=await g.readPage(e),r=await v.parseMarkdown(n),i;return Ne(r,o=>{if(o.type!=="FencedCode")return!1;let a=j(o,"CodeInfo");if(t&&!a||t&&!t.includes(a.children[0].text))return!1;let s=j(o,"CodeText");return s?(i=s.children[0].text,!0):!1}),i}async function me(e,t=["yaml"]){let n=await at(e,t);if(n!==void 0)try{return V(n)}catch(r){throw console.error("YAML Page parser error",r),new Error(`YAML Error: ${r.message}`)}}var Vo="SETTINGS";async function ie(e){try{let t=await me(Vo,["yaml"])||{},n={};for(let[r,i]of Object.entries(e))r in t?n[r]=t[r]:n[r]=i;return n}catch(t){if(t.message==="Not found")return e;throw t}}async function En(){let e=await g.listPages(),{pageTemplatePrefix:t}=await ie({pageTemplatePrefix:"template/page/"}),n=await c.filterBox("Template",e.filter(l=>l.name.startsWith(t)).map(l=>({...l,name:l.name.slice(t.length)})),`Select the template to create a new page from (listing any page starting with <tt>${t}</tt>)`);if(!n)return;console.log("Selected template",n);let r=await g.readPage(`${t}${n.name}`),i=await v.parseMarkdown(r),o=re(i,["$name","$disableDirectives"]);o.$name&&(o.$name=K(o.$name,""));let a=await c.prompt("Name of new page",o.$name);if(!a)return;try{if(await g.getPageMeta(a),!await c.confirm(`Page ${a} already exists, are you sure you want to override it?`))return}catch{}let s=K(S(i),a);await g.writePage(a,s),await c.navigate(a)}async function Ln(){let e=await g.listPages(),{snippetPrefix:t}=await ie({snippetPrefix:"snippet/"}),n=await c.getCursor(),r=await c.getCurrentPage(),i=e.filter(u=>u.name.startsWith(t)).map(u=>({...u,name:u.name.slice(t.length)})),o=await c.filterBox("Snippet",i,`Select the snippet to insert (listing any page starting with <tt>${t}</tt>)`);if(!o)return;let a=await g.readPage(`${t}${o.name}`),s=K(a,r),l=s.indexOf("|^|");s=s.replace("|^|",""),s=K(s,r),await c.insertAtCursor(s),l!==-1&&await c.moveCursor(n+l)}function K(e,t){return e.replaceAll(/\{\{([^\}]+)\}\}/g,(n,r)=>{switch(r){case"today":return H(new Date);case"tomorrow":{let i=new Date;return i.setDate(i.getDate()+1),H(i)}case"yesterday":{let i=new Date;return i.setDate(i.getDate()-1),H(i)}case"lastWeek":{let i=new Date;return i.setDate(i.getDate()-7),H(i)}case"nextWeek":{let i=new Date;return i.setDate(i.getDate()+7),H(i)}case"page":return t}return n})}async function Nn(){let{quickNotePrefix:e}=await ie({quickNotePrefix:"\u{1F4E5} "}),t=new Date().toISOString(),[n,r]=t.split("T");r=r.split(".")[0];let i=`${e}${n} ${r}`;await c.navigate(i)}async function On(){let{dailyNoteTemplate:e,dailyNotePrefix:t}=await ie({dailyNoteTemplate:"template/page/Daily Note",dailyNotePrefix:"\u{1F4C5} "}),n="";try{n=await g.readPage(e)}catch{console.warn(`No daily note template found at ${e}`)}let r=H(new Date),i=`${t}${r}`;if(n){try{await g.getPageMeta(i)}catch{await g.writePage(i,K(n,i))}await c.navigate(i)}else await c.navigate(i)}function Go(e=!1){let t=new Date,n=t.getDay(),r=t.getDate()-n;return e&&(r+=n==0?-6:1),new Date(t.setDate(r))}async function Rn(){let{weeklyNoteTemplate:e,weeklyNotePrefix:t,weeklyNoteMonday:n}=await ie({weeklyNoteTemplate:"template/page/Weekly Note",weeklyNotePrefix:"\u{1F5D3}\uFE0F ",weeklyNoteMonday:!1}),r="";try{r=await g.readPage(e)}catch{console.warn(`No weekly note template found at ${e}`)}let i=H(Go(n)),o=`${t}${i}`;if(r){try{await g.getPageMeta(o)}catch{await g.writePage(o,K(r,o))}await c.navigate(o)}else await c.navigate(o)}async function oe(e){let t=await c.getCursor(),n=await c.getCurrentPage(),r=e.value,i=r.indexOf("|^|");r=r.replace("|^|",""),r=K(r,n),await c.insertAtCursor(r),i!==-1&&await c.moveCursor(t+i)}async function $n(e){let t=await c.getCursor(),n=await c.getText(),r=new RegExp(e.match),i=t;for(;i>0&&n[i-1]!==`
`;)i--;let o=n.slice(i,t),a=!o;o=o.replace(r,e.replace),await c.dispatch({changes:{from:i,to:t,insert:o},selection:a?{anchor:i+o.length}:void 0})}async function Fn(){let e=await c.getText(),t=await c.getSelection(),n=t.from;for(;n>=0&&e[n]!==`
`;)n--;n++,e[n]===">"&&e[n+1]===" "?(e=e.slice(n+2,t.to),e=e.replaceAll(`
> `,`
`)):(e=e.slice(n,t.to),e=`> ${e.replaceAll(`
`,`
> `)}`),await c.replaceRange(n,t.to,e)}async function In(){let e=await c.getText(),t=await c.getSelection();if(t.to==0&&t.from==0){await c.insertAtCursor("* ");return}let n=t.from;for(e[n]==`
`&&n--;n>=0&&e[n]!==`
`;)n--;n++,e=e.slice(n,t.to),e=`* ${e.replaceAll(/\n(?!\n)/g,`
* `)}`,await c.replaceRange(n,t.to,e)}async function _n(){let e=await c.getText(),t=await c.getSelection(),n=t.from;for(;n>=0&&e[n]!==`
`;)n--;n++,e=e.slice(n,t.to);let r=1;e=`1. ${e.replaceAll(/\n(?!\n)/g,()=>(r++,`
${r}. `))}`,await c.replaceRange(n,t.to,e)}async function Dn(){let e=await c.getText(),t=await c.getSelection(),n=e.slice(t.from,t.to),r="[]()",i=1;if(n.length>0)try{new URL(n),r=`[](${n})`}catch{r=`[${n}]()`,i=r.length-1}await c.replaceRange(t.from,t.to,r),await c.moveCursor(t.from+i)}function q(e){return Ko(e.wrapper)}async function Ko(e){let t=await c.getText(),n=await c.getSelection();if(n.from===n.to)r(n.from)?await c.moveCursor(n.from+e.length):(await c.insertAtCursor(e+e),await c.moveCursor(n.from+e.length));else{let i=n.from,o=n.to,a=r(i);r(i)||(i=n.from-e.length,o=n.to+e.length,a=r(i)),a?(await c.replaceRange(i,o,t.substring(i+e.length,o-e.length)),await c.setSelection(i,o-e.length*2)):(await c.replaceRange(n.from,n.to,e+t.slice(n.from,n.to)+e),await c.setSelection(n.from+e.length,n.to+e.length))}function r(i){for(let o=0;o<e.length;o++)if(t[i+o]!==e[o])return!1;return!0}}async function Un(){let e=await c.prompt("New page title:","new page");if(!e)return;console.log("New name",e);try{throw await g.getPageMeta(e),new Error(`Page ${e} already exists, cannot rename to existing page.`)}catch(r){if(!r.message.includes("not found"))throw await c.flashNotification(r.message,"error"),r}let t=await c.getText(),n=await c.getSelection();t=t.slice(n.from,n.to),await c.replaceRange(n.from,n.to,`[[${e}]]`),console.log("Writing new page to space"),await g.writePage(e,t),console.log("Navigating to new page"),await c.navigate(e)}var jn=["collab","core","directive","emoji","markdown","share","tasks"];var zo=`This file lists all plugs that SilverBullet will load. Run the {[Plugs: Update]} command to update and reload this list of plugs.

`;async function Bn(){await c.save(),await c.flashNotification("Updating plugs...");try{let e=[];try{let r=await me("PLUGS");if(e=r.filter(i=>typeof i=="string"),e.length!==r.length)throw new Error("Some of the plugs were not in a yaml list format, they were ignored")}catch(r){if(r.message.includes("Could not read file")){console.warn("No PLUGS page found, not loading anything");return}throw new Error(`Error processing PLUGS: ${r.message}`)}console.log("Plug YAML",e);let t=[];for(let r of e){let[i,...o]=r.split(":"),a=await R.dispatchEvent(`get-plug:${i}`,o.join(":"));a.length===0&&console.error("Could not resolve plug",r);let s=a[0];t.push(s.name),await g.writeAttachment(`_plug/${s.name}.plug.json`,"utf8",JSON.stringify(s))}let n=[...jn,...t];for(let r of await g.listPlugs()){let i=r.substring(6,r.length-10);n.includes(i)||await g.deleteAttachment(r)}await c.flashNotification("And... done!")}catch(e){c.flashNotification("Error updating plugs: "+e.message,"error")}}async function Yn(){let e=await c.prompt("Plug URI:");if(!e)return;e.startsWith("-")&&(e=e.replace(/^\-\s*/,""));let t=[];try{t=await me("PLUGS")}catch(n){console.error("ERROR",n)}if(t.includes(e)){await c.flashNotification("Plug already installed","error");return}t.push(e),await g.writePage("PLUGS",zo+"```yaml\n"+t.map(n=>`- ${n}`).join(`
`)+"\n```"),await c.navigate("PLUGS"),await L.invokeFunction("server","updatePlugs"),await c.flashNotification("Plug added!"),L.reloadPlugs()}async function Ce(e){let t=`https:${e}`;console.log("Now fetching plug manifest from",t);let n=await fetch(t);if(n.status!==200)throw new Error(`Could not fetch plug manifest from ${t}`);return n.json()}function Hn(e){let[t,n,r]=e.split("/"),[i,o]=n.split("@");return o||(o="main"),Ce(`//raw.githubusercontent.com/${t}/${i}/${o}/${r}`)}async function qn(e){let[t,n,r]=e.split("/");if(!r||r==="latest"){console.log("fetching the latest version");let o=await fetch(`https://api.github.com/repos/${t}/${n}/releases/latest`);if(o.status!==200)throw new Error(`Could not fetch latest relase manifest from ${e}}`);r=(await o.json()).name}let i=`//github.com/${t}/${n}/releases/download/${r}/${n}.plug.json`;return Ce(i)}async function Wn(){console.log("AST",JSON.stringify(await v.parseMarkdown(await c.getText()),null,2))}async function Qn(){await c.showPanel("bhs",1,`
    <style>
    #close {
      width: 100%;
    }
    #client-log-header {
        position: absolute;
        left: 0;
        top: 35px;
    }
    #server-log-header {
        position: absolute;
        right: 0;
        top: 35px;
        width: 50%;
    }
    #client-log {
        position: absolute;
        left: 0;
        top: 60px;
        bottom: 0;
        width: 50%;
        overflow: scroll;
    }
    #server-log {
        position: absolute;
        right: 0;
        top: 60px;
        bottom: 0;
        width: 50%;
        overflow: scroll;
    }
    </style>
    <button onclick="self.close()" id="close">Close</button>
    <div id="client-log-header">Client logs (max 100)</div>
    <div id="client-log">Loading...</div>
    <div id="server-log-header">Server logs (max 100)</div>
    <div id="server-log">Loading...</div>`,`
      const clientDiv = document.getElementById("client-log");
      clientDiv.scrollTop = clientDiv.scrollHeight;
      const serverDiv = document.getElementById("server-log");
      serverDiv.scrollTop = serverDiv.scrollHeight;

      self.close = () => {
        syscall("event.dispatch", "log:hide");
      };

      syscall("system.getEnv").then((env) => {
        const clientServerMode = !!env;
        if (!clientServerMode) {
          // Running in hybrid mode (mobile), so let's ignore server logs (they're the same as client logs)
          serverDiv.style.display = "none";
          clientDiv.style.width = "100%";
          document.getElementById("server-log-header").style.display = "none";
        }
  
        setInterval(() => {
          Promise.resolve().then(async () => {
            if(clientServerMode) {
              const serverLogs = await syscall("sandbox.getServerLogs");
              serverDiv.innerHTML = "<pre>" + serverLogs.map((le) => "[" + le.level + "] " + le.message).join("\\n") + "</pre>";
            }
            const clientLogs = await syscall("sandbox.getLogs");
            clientDiv.innerHTML = "<pre>" + clientLogs.map((le) => "[" + le.level + "] " + le.message).join("\\n") + "</pre>";
          }).catch(console.error);
        }, 1000);
      });
      `)}async function Vn(){await c.hidePanel("bhs")}async function Gn(){let e=await v.parseMarkdown(await c.getText()),t=X(e,await c.getCursor()),n=t.children[0].text;console.log("Got URL to unfurl",n);let r=await R.dispatchEvent("unfurl:options",n),i=[];for(let a of r)i.push(...a);let o=await c.filterBox("Unfurl",i,"Select the unfurl strategy of your choice");if(!!o)try{let a=await L.invokeFunction("server","unfurlExec",o.id,n);await c.replaceRange(t?.from,t?.to,a)}catch(a){await c.flashNotification(a.message,"error")}}function Kn(){return[{id:"title-unfurl",name:"Extract title"}]}async function zn(e,t){let n=await R.dispatchEvent(`unfurl:${e}`,t);if(n.length===0)throw new Error("Unfurl failed");return n[0]}var Xo=/<title[^>]*>\s*([^<]+)\s*<\/title\s*>/i;async function Xn(e){let t=await fetch(e);if(t.status<200||t.status>=300)throw console.error("Unfurl failed",await t.text()),new Error(`Failed to fetch: ${await t.statusText}`);let n=await t.text(),r=Xo.exec(n);if(r)return`[${r[1]}](${e})`;throw new Error("No title found")}function Zo(e){let t=e.match(/youtube\.com\/watch\?v=([^&]+)/);return t||(t=e.match(/youtu.be\/([^&]+)/),t)?t[1]:null}function Zn(e){try{let t=V(e),n=t.url,r=Zo(n);return r&&(n=`https://www.youtube.com/embed/${r}`,t.width=t.width||560,t.height=t.height||315),{url:n,height:t.height,width:t.width}}catch(t){return{html:`ERROR: Could not parse body as YAML: ${t.message}`,script:""}}}function Jo(e){let t=e.match(/[\w\d\'-]+/gi);return t?t.length:0}function ea(e){return Math.ceil(e/225)}async function Jn(){let e=await c.getText(),t=await g.listPages(),n=Jo(e),r=ea(n);await c.flashNotification(`${e.length} characters; ${n} words; ${r} minutes read; ${t.length} total pages in space.`)}var st="\u{1F4AD} ";async function er(e,t){let n=e.substring(st.length,e.length-3),r=n;r.includes("/")||(r+="/index"),r.startsWith("127.0.0.1")?r=`http://${r}`:r=`https://${r}`;let i="";try{let o=await fetch(`${encodeURI(r)}.md`);i=await o.text(),o.ok||(i=`ERROR: ${i}`)}catch(o){console.error("ERROR thrown",o.message),i=`ERROR: ${o.message}`}return i=await ta(i,`${st}${n.split("/")[0]}/`),{data:t==="utf8"?i:ft("text/markdown",new TextEncoder().encode(i)),meta:{name:e,contentType:"text/markdown",lastModified:0,size:i.length,perm:"ro"}}}function tr(e){return console.log("Writing cloud file",e),lt(e)}async function ta(e,t){let n=await Ee(e);return F(n,r=>{r.type==="WikiLinkPage"&&(r.children[0].text.startsWith(st)||(r.children[0].text=t+r.children[0].text))}),e=S(n),e}function lt(e){return Promise.resolve({name:e,size:0,contentType:"text/markdown",lastModified:0,perm:"ro"})}async function nr(){let e=await O.get("vimMode");e=!e,await c.setUiOption("vimMode",e),await O.set("vimMode",e)}async function rr(){if(!await c.getUiOption("vimMode")){console.log("Not in vim mode");return}try{let t=await at("VIMRC");if(t){console.log("Now running vim ex commands from VIMRC");let n=t.split(`
`);for(let r of n)try{console.log("Running vim ex command",r),await c.vimEx(r)}catch(i){await c.flashNotification(i.message,"error")}}}catch{}}function ir(e){e().catch(t=>{console.error("Caught error",t.message)})}var Se=class{constructor(t,n=!0){this.print=n,this.callback=t}log(...t){this.push("log",t)}warn(...t){this.push("warn",t)}error(...t){this.push("error",t)}info(...t){this.push("info",t)}push(t,n){this.callback(t,this.logMessage(n)),this.print&&console[t](...n)}logMessage(t){let n=[];for(let r of t)switch(typeof r){case"string":case"number":n.push(""+r);break;case"undefined":n.push("undefined");break;default:try{let i=JSON.stringify(r,null,2);i.length>500&&(i=i.substring(0,500)+"..."),n.push(i)}catch{n.push("[circular object]")}}return n.join(" ")}};function na(e,t){return syscall("sandboxFetch.fetch",e,t)}function or(){globalThis.fetch=async function(e,t){let n=await na(e,t&&{method:t.method,headers:t.headers,body:t.body});return new Response(n.base64Body?mt(n.base64Body):null,{status:n.status,headers:n.headers})}}typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var ke=new Map;function fe(e){typeof window<"u"&&window.parent!==window?window.parent.postMessage(e,"*"):self.postMessage(e)}var ct=0;self.syscall=async(e,...t)=>await new Promise((n,r)=>{ct++,ke.set(ct,{resolve:n,reject:r}),fe({type:"syscall",id:ct,name:e,args:t})});var ra=new Map;self.require=e=>{console.log("Requiring",e);let t=ra.get(e);if(!t)throw new Error(`Dynamically importing non-preloaded library ${e}`);return t};self.console=new Se((e,t)=>{fe({type:"log",level:e,message:t})},!1);function ar(e,t){self.addEventListener("message",n=>{ir(async()=>{let r=n.data;switch(r.type){case"invoke":{let i=e[r.name];if(!i)throw new Error(`Function not loaded: ${r.name}`);try{let o=await Promise.resolve(i(...r.args||[]));fe({type:"result",id:r.id,result:o})}catch(o){fe({type:"result",id:r.id,error:o.message,stack:o.stack})}}break;case"syscall-response":{let i=r.id,o=ke.get(i);if(!o)throw console.log("Current outstanding requests",ke,"looking up",i),Error("Invalid request id");ke.delete(i),r.error?o.reject(new Error(r.error)):o.resolve(r.result)}break}})}),fe({type:"inited",manifest:t})}or();var sr={setEditorMode:ut,toggleDarkMode:pt,clearPageIndex:dn,pageQueryProvider:an,parseIndexTextRepublish:gn,reindexSpaceCommand:pn,reindexSpace:fn,deletePage:ln,attachmentQueryProvider:hn,indexLinks:on,linkQueryProvider:sn,renamePage:cn,pageComplete:mn,commandComplete:yn,indexItem:xn,itemQueryProvider:bn,linkNavigate:Pn,clickNavigate:An,navigateHome:vn,indexTags:Tn,tagComplete:Cn,tagProvider:Sn,indexAnchors:kn,anchorComplete:Mn,insertTemplateText:oe,applyLineReplace:$n,newPage:un,quickNoteCommand:Nn,dailyNoteCommand:On,weeklyNoteCommand:Rn,instantiateTemplateCommand:En,insertSnippet:Ln,insertTodayCommand:oe,insertTomorrowCommand:oe,quoteSelectionCommand:Fn,listifySelection:In,numberListifySelection:_n,linkSelection:Dn,bold:q,italic:q,strikethrough:q,marker:q,extractToPageCommand:Un,updatePlugsCommand:Bn,getPlugHTTPS:Ce,getPlugGithub:Hn,getPlugGithubRelease:qn,addPlugCommand:Yn,parseCommand:Wn,showLogsCommand:Qn,hideBhsCommand:Vn,unfurlLink:Gn,unfurlExec:zn,titleUnfurlOptions:Kn,titleUnfurl:Xn,embedWidget:Zn,statsCommand:Jn,readPageCloud:er,writePageCloud:tr,getPageMetaCloud:lt,toggleVimMode:nr,loadVimRc:rr},ia={name:"core",imports:["https://get.silverbullet.md/global.plug.json"],syntax:{Hashtag:{firstCharacters:["#"],regex:"#[^#\\d\\s\\[\\]]+\\w+",className:"sb-hashtag"},NakedURL:{firstCharacters:["h"],regex:"https?:\\/\\/[-a-zA-Z0-9@:%._\\+~#=]{1,256}([-a-zA-Z0-9()@:%_\\+.~#?&=\\/]*)",className:"sb-naked-url"},NamedAnchor:{firstCharacters:["$"],regex:"\\$[a-zA-Z\\.\\-\\/]+[\\w\\.\\-\\/]*",className:"sb-named-anchor"}},functions:{setEditorMode:{path:"./editor.ts:setEditorMode",events:["editor:init"]},toggleDarkMode:{path:"./editor.ts:toggleDarkMode",command:{name:"Editor: Toggle Dark Mode"}},clearPageIndex:{path:"./page.ts:clearPageIndex",env:"server",events:["page:saved","page:deleted"]},pageQueryProvider:{path:"./page.ts:pageQueryProvider",events:["query:page"]},parseIndexTextRepublish:{path:"./page.ts:parseIndexTextRepublish",events:["page:index_text"]},reindexSpaceCommand:{path:"./page.ts:reindexCommand",command:{name:"Space: Reindex"}},reindexSpace:{path:"./page.ts:reindexSpace",env:"server"},deletePage:{path:"./page.ts:deletePage",command:{name:"Page: Delete"}},attachmentQueryProvider:{path:"./attachment.ts:attachmentQueryProvider",events:["query:attachment"]},indexLinks:{path:"./page.ts:indexLinks",events:["page:index"]},linkQueryProvider:{path:"./page.ts:linkQueryProvider",events:["query:link"]},renamePage:{path:"./page.ts:renamePage",command:{name:"Page: Rename",mac:"Cmd-Alt-r",key:"Ctrl-Alt-r",page:""}},pageComplete:{path:"./page.ts:pageComplete",events:["editor:complete"]},commandComplete:{path:"./command.ts:commandComplete",events:["editor:complete"]},indexItem:{path:"./item.ts:indexItems",events:["page:index"]},itemQueryProvider:{path:"./item.ts:queryProvider",events:["query:item"]},linkNavigate:{path:"./navigate.ts:linkNavigate",command:{name:"Navigate To page",key:"Ctrl-Enter",mac:"Cmd-Enter"}},clickNavigate:{path:"./navigate.ts:clickNavigate",events:["page:click"]},navigateHome:{path:"./navigate.ts:navigateCommand",command:{name:"Navigate: Home",key:"Alt-h",page:""}},indexTags:{path:"./tags.ts:indexTags",events:["page:index"]},tagComplete:{path:"./tags.ts:tagComplete",events:["editor:complete"]},tagProvider:{path:"./tags.ts:tagProvider",events:["query:tag"]},indexAnchors:{path:"./anchor.ts:indexAnchors",events:["page:index"]},anchorComplete:{path:"./anchor.ts:anchorComplete",events:["editor:complete"]},insertTemplateText:{path:"./template.ts:insertTemplateText"},applyLineReplace:{path:"./template.ts:applyLineReplace"},insertFrontMatter:{redirect:"insertTemplateText",slashCommand:{name:"front-matter",description:"Insert page front matter",value:`---
|^|
---
`}},makeH1:{redirect:"applyLineReplace",slashCommand:{name:"h1",description:"Turn line into h1 header",match:"^#*\\s*",replace:"# "}},makeH2:{redirect:"applyLineReplace",slashCommand:{name:"h2",description:"Turn line into h2 header",match:"^#*\\s*",replace:"## "}},makeH3:{redirect:"applyLineReplace",slashCommand:{name:"h3",description:"Turn line into h3 header",match:"^#*\\s*",replace:"### "}},makeH4:{redirect:"applyLineReplace",slashCommand:{name:"h4",description:"Turn line into h4 header",match:"^#*\\s*",replace:"#### "}},newPage:{path:"./page.ts:newPageCommand",command:{name:"Page: New",key:"Alt-Shift-n"}},insertHRTemplate:{redirect:"insertTemplateText",slashCommand:{name:"hr",description:"Insert a horizontal rule",value:"---"}},insertTable:{redirect:"insertTemplateText",slashCommand:{name:"table",description:"Insert a table",boost:-1,value:`| Header A | Header B |
|----------|----------|
| Cell A|^| | Cell B |
`}},quickNoteCommand:{path:"./template.ts:quickNoteCommand",command:{name:"Quick Note",key:"Alt-Shift-n",priority:1}},dailyNoteCommand:{path:"./template.ts:dailyNoteCommand",command:{name:"Open Daily Note",key:"Alt-Shift-d"}},weeklyNoteCommand:{path:"./template.ts:weeklyNoteCommand",command:{name:"Open Weekly Note",key:"Alt-Shift-w"}},instantiateTemplateCommand:{path:"./template.ts:instantiateTemplateCommand",command:{name:"Template: Instantiate Page"}},insertSnippet:{path:"./template.ts:insertSnippet",command:{name:"Template: Insert Snippet"},slashCommand:{name:"snippet",description:"Insert a snippet"}},insertTodayCommand:{path:"./template.ts:insertTemplateText",slashCommand:{name:"today",description:"Insert today's date",value:"{{today}}"}},insertTomorrowCommand:{path:"./template.ts:insertTemplateText",slashCommand:{name:"tomorrow",description:"Insert tomorrow's date",value:"{{tomorrow}}"}},quoteSelectionCommand:{path:"./text.ts:quoteSelection",command:{name:"Text: Quote Selection",key:"Ctrl-Shift-.",mac:"Cmd-Shift-."}},listifySelection:{path:"./text.ts:listifySelection",command:{name:"Text: Listify Selection",key:"Ctrl-Shift-8",mac:"Cmd-Shift-8"}},numberListifySelection:{path:"./text.ts:numberListifySelection",command:{name:"Text: Number Listify Selection"}},linkSelection:{path:"./text.ts:linkSelection",command:{name:"Text: Link Selection",key:"Ctrl-Shift-k",mac:"Cmd-Shift-k"}},bold:{path:"./text.ts:wrapSelection",command:{name:"Text: Bold",key:"Ctrl-b",mac:"Cmd-b",wrapper:"**"}},italic:{path:"./text.ts:wrapSelection",command:{name:"Text: Italic",key:"Ctrl-i",mac:"Cmd-i",wrapper:"_"}},strikethrough:{path:"./text.ts:wrapSelection",command:{name:"Text: Strikethrough",key:"Ctrl-Shift-s",mac:"Cmd-Shift-s",wrapper:"~~"}},marker:{path:"./text.ts:wrapSelection",command:{name:"Text: Marker",key:"Alt-m",wrapper:"=="}},extractToPageCommand:{path:"./refactor.ts:extractToPage",command:{name:"Extract text to new page"}},updatePlugsCommand:{path:"./plugmanager.ts:updatePlugsCommand",command:{name:"Plugs: Update",key:"Ctrl-Shift-p",mac:"Cmd-Shift-p"}},getPlugHTTPS:{path:"./plugmanager.ts:getPlugHTTPS",events:["get-plug:https"]},getPlugGithub:{path:"./plugmanager.ts:getPlugGithub",events:["get-plug:github"]},getPlugGithubRelease:{path:"./plugmanager.ts:getPlugGithubRelease",events:["get-plug:ghr"]},addPlugCommand:{path:"./plugmanager.ts:addPlugCommand",command:{name:"Plugs: Add"}},parseCommand:{path:"./debug.ts:parsePageCommand",command:{name:"Debug: Parse Document"}},showLogsCommand:{path:"./debug.ts:showLogsCommand",command:{name:"Show Logs",key:"Ctrl-Alt-l",mac:"Cmd-Alt-l"}},hideBhsCommand:{path:"./debug.ts:hideBhsCommand",command:{name:"UI: Hide BHS",key:"Ctrl-Alt-b",mac:"Cmd-Alt-b"},events:["log:hide"]},unfurlLink:{path:"./link.ts:unfurlCommand",command:{name:"Link: Unfurl",key:"Ctrl-Shift-u",mac:"Cmd-Shift-u",contexts:["NakedURL"]}},unfurlExec:{env:"server",path:"./link.ts:unfurlExec"},titleUnfurlOptions:{path:"./link.ts:titleUnfurlOptions",events:["unfurl:options"]},titleUnfurl:{path:"./link.ts:titleUnfurl",events:["unfurl:title-unfurl"]},embedWidget:{path:"./embed.ts:embedWidget",codeWidget:"embed"},statsCommand:{path:"./stats.ts:statsCommand",command:{name:"Stats: Show"}},readPageCloud:{path:"./cloud.ts:readFileCloud",env:"server",pageNamespace:{pattern:"\u{1F4AD} .+",operation:"readFile"}},writePageCloud:{path:"./cloud.ts:writeFileCloud",env:"server",pageNamespace:{pattern:"\u{1F4AD} .+",operation:"writeFile"}},getPageMetaCloud:{path:"./cloud.ts:getFileMetaCloud",env:"server",pageNamespace:{pattern:"\u{1F4AD} .+",operation:"getFileMeta"}},toggleVimMode:{path:"./vim.ts:toggleVimMode",command:{name:"Editor: Toggle Vim Mode"}},loadVimRc:{path:"./vim.ts:loadVimRc",command:{name:"Editor: Vim: Load VIMRC"},events:["editor:modeswitch"]}},assets:{}};ar(sr,ia);return mr(oa);})();
